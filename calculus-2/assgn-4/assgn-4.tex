\documentclass[10pt]{article}
\usepackage{mathtools}
\usepackage{minted}
\usepackage{amsfonts}
\usepackage{pifont}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\newcommand*{\dTdt}[0]{\frac{\text{d}T}{\text{d}t}}
\newcommand*{\dydx}[0]{\frac{\text{d}y}{\text{d}x}}
\newcommand*{\dy}[0]{\text{d}y}
\newcommand*{\dx}[0]{\text{d}x}
\newcommand*{\dt}[0]{\text{d}t}
\newcommand*{\dT}[0]{\text{d}T}
\newcommand*{\D}[2]{\frac{\partial{#1}}{\partial{#2}}}%
\newcommand*{\df}[2]{\frac{\text{d}{#1}}{\text{d}{#2}}}%
\author{BM Corser}
\title{Calculus 2, Assignment 4}
\date{}
\begin{document}
    \maketitle 
    \begin{enumerate}
        \item 
        \begin{enumerate}
            \item In this context, $k$ cannot be 0, since $k = 0$ implies there
                is no relationship between $\dTdt$ and $T_s - T$. This gives us
                $|k| > 0$. However, I don't see a ``colloquial" reason for $k >
                0$, since either or both of $T_s$ and $T$ can be negative. I
                can see it's in some sense meaningless to take a negative
                factor, since if $a$ is a factor of $b$ then $-a$ is also a
                factor of $b$.

                ...

                Also, having found $T$, it is clear that (for the model to be
                sane) as $t \rightarrow \infty$, $T \rightarrow T_s$ and so we
                can write
                    $$\text{when } T_s \geq T, T_s - T \geq 0, \dTdt \geq 0 \text{ therefore } k > 0$$
                    and
                    $$\text{when } T_s \leq T, T_s - T \leq 0, \dTdt \leq 0 \text{ therefore } k > 0.$$
            \item $\df{T}{t} = k(T_s - T)$ is a first order variables separable
                ordinary differential equation and as such
                \begin{align*}
                    \int\frac{1}{T_s - T}\dT &= k\int \dt \\
                    -\ln(T_s - T)&= k(t + c)  \text{ where $c$ is of the form $a + \tfrac{b}{k}$}\\
                    T_s - T &=  e^{-k(t + c)}\\
                    T &= T_s - e^{-k(t+c)}. \\
                \end{align*}
            If $T = T_0$ when $t = 0$
                \begin{align*}
                    T_0 &= T_s - e^{-kc} \\
                    e^{-kc} &= T_s - T_0 \\
                    c &= -\frac{\ln(T_s - T_0)}{k} \\
                \end{align*}
                so
                \begin{align*}
                    T &= T_s - e^{-k\left(t-\tfrac{\ln(T_s - T_0)}{k}\right)} \\
                      &= T_s - e^{\ln(T_s - T_0)-kt} \\
                      &= T_s - \frac{e^{\ln(T_s - T_0)}}{e^{kt}} \\
                      &= T_s - \frac{T_s - T_0}{e^{kt}}. \\
                \end{align*}
            \item We are given $T(0) = 37$ and $T_s = 24$. 
                \begin{enumerate}
                    \item Let the amount of time between death and discovery be
                        $A$, now $T(A) = 34$, $T(A + 30) = 32$ and
                    \begin{align*}
                        e^{kA} &= \frac{13}{10} \\
                        kA &= \ln\left(\tfrac{13}{10}\right), \\
                        e^{k(A+30)} &= \frac{13}{8} \\
                        kA+k30 &= \ln\left(\tfrac{13}{8}\right). \\
                    \end{align*}
                    Substituting our value for $kA$ into the second equation
                    \begin{align*}
                        k &= \frac{\ln\left(\tfrac{13}{8}\right) - \ln\left(\tfrac{13}{10}\right)}{30} \\
                        &= \frac{\ln\left(\tfrac{5}{4}\right)}{30}. \\
                    \end{align*}
                \item With a value for $k$,
                        $$T = T_s - (T_s - T_0)\cdot\exp{\left(-\frac{A\ln\left(\tfrac{5}{4}\right)}{30}\right)}$$
                    and
                    \begin{align*}
                        34 &= 24 - (-13)\cdot\exp{\left(-\frac{A\ln\left(\tfrac{5}{4}\right)}{30}\right)} \\
                        A &= -\frac{30\ln\left(\tfrac{10}{13}\right)}{\ln\left(\tfrac{5}{4}\right)} \\
                        &\approx 35.2729347...,
                    \end{align*}
                    which tells us the time of death was about 35 minutes before
                    high noon.
                \item I was returning some video tapes.
                \item Since the model we have considers surrounding temperature
                    to be constant, I have found in the past that the turning
                        the thermostat up or down before leaving the scene of
                        the crime works nicely. What? Sorry, I have to return
                        some video tapes.
             \end{enumerate}
        \end{enumerate}
             \item
            \begin{enumerate}
                \item
                \begin{enumerate}
                    \item Since $f$ is even, $g(f(-x)) = g(f(x))$ and so $g \circ
                        f$ is even. Similarly, $f(g(-x)) = f(-g(x)) = f(g(x))$ so
                        $f \circ g$ is also even.
                    \item $f(-x)g(-x) = f(x)(-g(x)) = -f(x)g(x)$ so $f(x)g(x)$ is
                        odd. Similarly, $\frac{f(-x)}{g(-x)} = \frac{f(x)}{-g(x)} =
                        -\frac{f(x)}{g(x)}$ and so $\frac{f(x)}{g(x)}$ is also odd.
                    \item The definition of the chain rule is
                        $\dydx = \df{y}{u} \cdot \df{u}{x}$. Since
                        $f(x) = f(-x)$, if we let $y = f$ and $u = -x$ then
                        \begin{align*}
                            \df{f(-x)}{x} &= \df{f(u)}{u} \cdot \df{u}{x}, \\
                            \df{u}{x} &= -1, \\
                            \df{f(-x)}{x} &= \df{f(u)}{u} \cdot (-1) \\
                             &= -\df{f(x)}{x}. \\
                        \end{align*}
                        Similarly, since $g(-x) = -g(x)$,
                        \begin{align*}
                            \df{g(-x)}{x} &= \df{g(u)}{u} \cdot \df{u}{x}, \\
                            \df{u}{x} &= -1, \\
                            \df{g(-x)}{x} &= \df{g(u)}{u} \cdot (-1) \\
                             &= \df{g(-x)}{x} \cdot (-1) \\
                             &= \df{\left(-g(x)\right)}{x} \cdot (-1) \\
                             &= (-1)\cdot\df{g(x)}{x} \cdot (-1) \\
                             &= \df{g(x)}{x} \\
                        \end{align*}
                \end{enumerate}
                \item
                    \begin{enumerate}
                        \item $h_e(-x) = \frac{1}{2}(h(-x) + h(x)) = h_e(x)$ and $h_e$ is even, also
                        $h_o(-x) = \frac{1}{2}(h(-x) - h(x)) = -h_o(x)$  and $h_o$ is odd.
                    \item $f(x) = x^2 + x$, $f$ is their even nor odd. Let $h_e
                        = x^2$ and $h_o = x$, $h_e$ is even, $h_o$ is odd,
                            $f(x) = h_e(x) + h_o(x)$.
                    \end{enumerate}
            \end{enumerate}
            \item
                \begin{enumerate}
                    \item 
                        \begin{align*}
                            \ddot{x} &= t^2 + bt + c \\
                            \dot{x} &= \frac{t^3}{3} + b\frac{t^2}{2} + ct \\
                            x &= \frac{t^4}{12} + b\frac{t^3}{6} + ct^2 \\
                        \end{align*}
                    \item Since we are told that the particle is ``at rest"
                        when $t = 0$, we know $c = ct = ct^2 = 0$ (this is also
                        why I have ignored other constants of integration
                        above). Now let $b = -\tfrac{1}{2}$ and consider our
                        equation for displacement at $t = 1$.
                        \begin{align*}
                            x(1) &= \frac{1}{12} + (-\frac{1}{2})\cdot\frac{1}{6} + 0 \\
                                 &= \frac{1}{12} - \frac{1}{12} \\
                                 &=0
                        \end{align*}
                    \item As $t \rightarrow \infty$ all of $\ddot{x}$,
                        $\dot{x}$ and $x$ will also go to infinity; the
                        particle will have infinite acceleration, achieve
                        infinite speed and travel infinitely far.
                \end{enumerate}
            \item
                \begin{align*}
                    \dydx &= 3xy \\
                    \df{^2y}{x^2} &= 3x\dydx + 3y \\
                         &= 9x^2y + 3y \\
                    \df{^3y}{x^3} &= 3\dydx + 3x\df{^2y}{x^2} + 3\dydx \\
                    \df{^3y}{x^3} &= 6\dydx + 3x\df{^2y}{x^2} \\
                    &= 18x^2y + 27x^3y + 9xy\\
                \end{align*}
                and
                \begin{align*}
                    y_{i+1} &= y_i + h\dydx + \frac{h^2}{2!}\df{^2y}{x^2} + \frac{h^3}{3!}\df{^3y}{x^3}. \\
                \end{align*}

                \pagebreak

                Writing a Python program that expresses the above (and is is
                general over derivative terms, see the \mintinline{python}{terms}
                variable) might look like the following
                \begin{minted}[linenos]{python}
                
from math import factorial

def d1(x, y):  # first derivative
    return 3 * x * y

def d2(x, y):  # second derivative
    return 3 * x * d1(x, y) + 3 * y

def d3(x, y):  # third derivative
    return 6 * d1(x, y) + 3 * x * d2(x, y)

terms = [d1, d2, d3]
initial_condition = 0.5
step = 0.1

def x(i):
    return step * i

def h(i):
    return pow(step, i) / factorial(i)

def euler(i, n, d):
    return h(n) * d(x(i), y(i))

def y(i_1):  # i_1 means i + 1
    if i_1 == 0:
        return initial_condition
    i = i_1 - 1
    return y(i) + sum([
        euler(i, n + 1, d) for n, d in enumerate(terms)
    ])

tab_fmt = "{0} & {1} & {2:.6f} \\\\"
for i in range(0, 5):
    print(tab_fmt.format(i, x(i), y(i)))

                \end{minted}
    Lines 33-35 format output suitable for {\LaTeX} as follows

    \begin{tabular}{| c | c | c |}
        \hline
        $i$ & $x_i$ & $y_i$ \\
        \hline
        0 & 0.0 & 0.500000 \\
        1 & 0.1 & 0.507500 \\
        2 & 0.2 & 0.530797 \\
        3 & 0.3 & 0.572059 \\
        4 & 0.4 & 0.635283 \\
        \hline
    \end{tabular}
    \end{enumerate}
\end{document}
